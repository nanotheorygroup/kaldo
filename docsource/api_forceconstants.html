
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  <script>
      window.ga = window.ga || function () {
          (ga.q = ga.q || []).push(arguments)
      };
      ga.l = +new Date;
      ga('create', 'UA-172053863-1', 'auto');
      ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  
  
    <title>ForceConstants &#8212; kALDo  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="shortcut icon" href="../_static/logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Phonons" href="api_phonons.html" />
    <link rel="prev" title="Interfacing with Other Codes" href="user_guide.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=red data-md-color-accent=orange>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#docsource/api_forceconstants" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="kALDo  documentation"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">kALDo</span>
          <span class="md-header-nav__topic"> ForceConstants </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/nanotheorygroup/kaldo" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    kALDo
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">kALDo  documentation</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="kALDo documentation" class="md-nav__button md-logo">
      
        <img src="../_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="kALDo documentation">kALDo</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/nanotheorygroup/kaldo" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    kALDo
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Introduction</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="introduction.html" class="md-nav__link">Overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="introduction.html#Features" class="md-nav__link">Features</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Getting Started</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="getting_started.html" class="md-nav__link">Quick Install</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">User Guide</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="theory.html" class="md-nav__link">Basic Concepts</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="theory.html#Workflow" class="md-nav__link">Workflow</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="user_guide.html" class="md-nav__link">Interfacing with Other Codes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="user_guide.html#Output-Storage" class="md-nav__link">Output Storage</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="user_guide.html#Units" class="md-nav__link">Units</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Reference</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> ForceConstants </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">ForceConstants</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#docsource-api-forceconstants--page-root" class="md-nav__link">ForceConstants</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#calculating-ifcs-in-kaldo" class="md-nav__link">Calculating IFCs in kALDo</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#should-i-use-kaldo-to-calculate-my-ifcs" class="md-nav__link">Should I use kALDo to calculate my IFCs?</a>
        </li>
        <li class="md-nav__item"><a href="#calculation-workflow" class="md-nav__link">Calculation Workflow</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#loading-precalculated-ifcs" class="md-nav__link">Loading Precalculated IFCs</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#input-files-and-formats" class="md-nav__link">Input Files and Formats</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#api-reference" class="md-nav__link">API Reference</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/docsource/api_forceconstants.rst.txt">Show Source</a> </li>

  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="api_phonons.html" class="md-nav__link">Phonons</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="api_conductivity.html" class="md-nav__link">Conductivity</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Tutorials and examples</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="crystal_presentation.html" class="md-nav__link">Silicon diamond tutorial</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="amorphous_presentation.html" class="md-nav__link">Amorphous silicon tutorial</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="examples.html" class="md-nav__link">Examples</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Citations</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="citations.html" class="md-nav__link">How to cite</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../publications/readme.html" class="md-nav__link">Publications using kALDo</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="other_codes.html" class="md-nav__link">Other codes</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Developer Guide</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="code_architecture.html" class="md-nav__link">Code Architecture</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="contributing.html" class="md-nav__link">How to contribute changes</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Acknowledgements</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="credits.html" class="md-nav__link">Acknowledgements</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">License</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="license.html" class="md-nav__link">License Information</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="license.html#copyright" class="md-nav__link">Copyright</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#docsource-api-forceconstants--page-root" class="md-nav__link">ForceConstants</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#calculating-ifcs-in-kaldo" class="md-nav__link">Calculating IFCs in kALDo</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#should-i-use-kaldo-to-calculate-my-ifcs" class="md-nav__link">Should I use kALDo to calculate my IFCs?</a>
        </li>
        <li class="md-nav__item"><a href="#calculation-workflow" class="md-nav__link">Calculation Workflow</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#loading-precalculated-ifcs" class="md-nav__link">Loading Precalculated IFCs</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#input-files-and-formats" class="md-nav__link">Input Files and Formats</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#api-reference" class="md-nav__link">API Reference</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/docsource/api_forceconstants.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="forceconstants">
<span id="forceconstants-frontmatter"></span><h1 id="docsource-api-forceconstants--page-root">ForceConstants<a class="headerlink" href="#docsource-api-forceconstants--page-root" title="Permalink to this heading">¶</a></h1>
<p>The ForceConstants class creates objects that store the system information and load (or calculate) force constant
matrices (IFCs) to be used by an instance of the <a class="reference internal" href="api_phonons.html#phonons-api"><span class="std std-ref">Phonon</span></a> class. This is normally the first thing you
should initialize when working with kALDo and we’ll walk you through how to do that in the following sections on this
page. Initializing a ForceConstants object will also initialize SecondOrder and ThirdOrder containers that you can
access as attributes. Refer to the section on <a class="reference internal" href="#loading-ifcs"><span class="std std-ref">Loading Precalculated IFCs</span></a>.</p>
<section id="calculating-ifcs-in-kaldo">
<span id="calculating-ifcs"></span><h2 id="calculating-ifcs-in-kaldo">Calculating IFCs in kALDo<a class="headerlink" href="#calculating-ifcs-in-kaldo" title="Permalink to this heading">¶</a></h2>
<p>We use the finite difference approach, or sometimes called the frozen-phonon method. This method neglects temperature
effects on phonon frequency and velocities, but it’s a good approximation if your system is far from melting (well-below
the Debye Temperature).</p>
<p>The basic idea is we explicitly calculate the change in forces on atoms when they are displaced from their equilibrium
and use this to approximate the true derivative of the potential energy at equilibrium. You should keep aim to keep the
displacements small, but not so small that the potential you’re using can’t resolve the change in forces. On empirical
potentials like Tersoff, you can try pretty small displacements (1e-5 Angstroms) but on more complex potentials like
machine learning potentials you may need to use larger displacements (1e-3 Angstroms).</p>
<p>For a system with N atoms, the number of second order IFCs is <img alt="(3N)^2" class="math" src="../_images/math/943b51971dfc95a6b3301a233a3f32d107744154.png"/> but, because each frame returns <img alt="3N" class="math" src="../_images/math/72fc2a67dca9b9745c655b8c94b7ed0b128a3e76.png"/>
forces, we only need to calculate <img alt="\frac{(3N)^2}{3N} = 3N" class="math" src="../_images/math/6fd4fb45b29b4d16d1c84080f868746cc3f48958.png"/> frames. However, the finite difference method uses 2
displacements (+/-) to approximate the derivative so total number is actually <img alt="2\times 3N = 6N" class="math" src="../_images/math/0a8198ef7af907a622793e52ad3d15ff6efaa91f.png"/>.</p>
<p>Each term of the third order FCs are calculated with 2 derivatives calculated with 2 displacements, so the total number
of frames is <img alt="2 \times 2 \times 3N \times 3N = (6N)^2" class="math" src="../_images/math/23db063e872f4ae961f9f93691df661297505110.png"/>.</p>
<section id="should-i-use-kaldo-to-calculate-my-ifcs">
<h3 id="should-i-use-kaldo-to-calculate-my-ifcs">Should I use kALDo to calculate my IFCs?<a class="headerlink" href="#should-i-use-kaldo-to-calculate-my-ifcs" title="Permalink to this heading">¶</a></h3>
<p>It’s faster to use compiled software like LAMMPS or Quantum Espresso to generate the IFCs when possible. However, if
your system is small ( hundreds to a few thousand atoms ), it may be tractable to calculate them here. The following are
some general cases where you could calculate it all here without a significant performance hit:</p>
<ul class="simple">
<li><p>You want to explore the effect of different potentials on only harmonic phonon properties (so no third order needed).</p></li>
<li><p>Small systems with short ranges of interactions</p></li>
<li><p>Users have a custom potential (particularly when it can be calculated within python)</p></li>
<li><p>Systems have no symmetry (which many of the compiled software packages exploit to greatly reduce total calculations)</p></li>
</ul>
<p>If you’re not sure, <code class="xref py py-meth docutils literal notranslate"><span class="pre">SecondOrder.calculate()</span></code> prints to stdout the atom its currently working on so run the
calculation and stop it after it prints a few atoms. Take the average time per atom and divide by 6 to get the time per
frame <img alt="t_{pf}" class="math" src="../_images/math/9f14a8e6da3ddfa543729eba3de6042255fa74e8.png"/> including overhead of I/O operations, launching tasks, etc. The total times are given by:</p>
<div class="math">
<p><img alt="t_{2nd Order} = t_{pf} \times {6N}" src="../_images/math/5c5c0709424518b8e9d8eef9841e7460f8dd32d4.png"/></p>
</div><div class="math">
<p><img alt="t_{3rd Order} = t_{pf} \times {6N}^2" src="../_images/math/8c813aba5341d33ab205ccb2c6f02d52d7827c29.png"/></p>
</div></section>
<section id="calculation-workflow">
<h3 id="calculation-workflow">Calculation Workflow<a class="headerlink" href="#calculation-workflow" title="Permalink to this heading">¶</a></h3>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Be sure to minimize the potential energy of your atomic positions before calculating the IFCs. The steps here assume
you have already done this.</p>
</div>
<ol class="arabic">
<li><p>Import required packages which will be kALDo, the ASE calculator you want to use, and either a function to build
atoms (like ase.build.bulk) or their read tool (ase.io.read):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">kaldo.forceconstants</span> <span class="kn">import</span> <span class="n">ForceConstants</span>
<span class="kn">from</span> <span class="nn">ase.io</span> <span class="kn">import</span> <span class="n">read</span>
<span class="kn">from</span> <span class="nn">ase.build</span> <span class="kn">import</span> <span class="n">bulk</span>
<span class="kn">from</span> <span class="nn">ase.calculatos.lammpslib</span> <span class="kn">import</span> <span class="n">LAMMPSlib</span>
</pre></div>
</div>
</li>
</ol>
<ol class="arabic">
<li><p>Create your Atoms, Calculator and ForceConstants object. If you don’t set a “folder” argument for the ForceConstants
object the default save location is “displacements”. See <a class="reference external" href="asecalc">the ASE docs</a> for information on their
calculators:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the Atoms object</span>
<span class="n">atoms</span> <span class="o">=</span> <span class="n">bulk</span><span class="p">(</span><span class="s1">'C'</span><span class="p">,</span> <span class="s1">'diamond'</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">3.567</span><span class="p">)</span>
<span class="c1"># Create the ASE calculator object</span>
<span class="n">calc</span> <span class="o">=</span> <span class="n">LAMMPSlib</span><span class="p">(</span><span class="n">lmpcmds</span><span class="o">=</span><span class="p">[</span><span class="s1">'pair_style tersoff'</span><span class="p">,</span>
                          <span class="s1">'pair_coeff * * SiC.tersoff C'</span><span class="p">],</span>
                 <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">'control'</span><span class="p">:</span> <span class="s1">'energy'</span><span class="p">,</span>
                                 <span class="s1">'log'</span><span class="p">:</span> <span class="s1">'none'</span><span class="p">,</span>
                                <span class="s1">'pair'</span><span class="p">:</span> <span class="s1">'tersoff'</span><span class="p">,</span>
                                <span class="s1">'mass'</span><span class="p">:</span> <span class="s1">'1 12.01'</span><span class="p">,</span>
                            <span class="s1">'boundary'</span><span class="p">:</span> <span class="s1">'p p p'</span><span class="p">},</span>
                 <span class="n">files</span><span class="o">=</span><span class="p">[</span><span class="s1">'SiC.tersoff'</span><span class="p">]))</span>
<span class="c1"># Create the ForceConstants object</span>
<span class="n">fc</span> <span class="o">=</span> <span class="n">ForceConstants</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span>
                    <span class="n">supercell</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                    <span class="n">folder</span><span class="o">=</span><span class="s1">'path_to_save_IFCS/'</span><span class="p">,)</span>
</pre></div>
</div>
</li>
<li><p>Now use the “calculate” methods of the second and third order objects by passing in the calculator as an argument.
The “delta_shift” argument is how far the atoms move.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Second Order (for harmonic properties - phonon frequencies, velocities, heat capacity, etc.)</span>
<span class="n">fc</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">calc</span><span class="p">)</span>
<span class="c1"># Third Order (for anharmonic properties - phonon lifetimes, thermal conductivity, etc.)</span>
<span class="n">fc</span><span class="o">.</span><span class="n">third</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">calc</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
<p>Try referencing the <a class="reference external" href="https://github.com/nanotheorygroup/kaldo/blob/main/examples/carbon_diamond_Tersoff_ASE_LAMMPS/1_C_Tersoff_fc_and_harmonic_properties.py">carbon diamond example</a> to see an example where we use kALDo and ASE to control LAMMPS
calculations.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Some libraries, like LAMMPS, can use either a python wrapper (LAMMPSlib) or a direct call to the binary
executable (LAMMPSrun). We don’t notice a significant performance increase by using the direct call method, because
the bottleneck is the I/O of data back to python. This is part of the reason our examples use the python wrapper,
which offers more flexibility without losing access to the full LAMMPS functionality.</p>
</div>
</section>
</section>
<section id="loading-precalculated-ifcs">
<span id="loading-ifcs"></span><h2 id="loading-precalculated-ifcs">Loading Precalculated IFCs<a class="headerlink" href="#loading-precalculated-ifcs" title="Permalink to this heading">¶</a></h2>
<p>Construct your ForceConstants object by using the <code class="xref py py-obj docutils literal notranslate"><span class="pre">from_folder</span></code> method. The first step of
the <a class="reference external" href="https://github.com/nanotheorygroup/kaldo/blob/main/examples/amorphous_silicon_Tersoff_LAMMPS/1_aSi512_Tersoff_thermal_conductivity.py">amorphous silicon example</a> can help you get started.
If you’d like to load IFCs into the already-created instances without the <code class="xref py py-meth docutils literal notranslate"><span class="pre">from_folder()</span></code> generate the
ForceConstants object and then use the <code class="xref py py-meth docutils literal notranslate"><span class="pre">load()</span></code> method of the SecondOrder and ThirdOrder objects to pull data as
needed.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>If you just want to check harmonic data first, use the “is_harmonic” argument when creating the ForceConstants object
to only load the second order IFCs. This can save considerable amounts of time if, for instance, you just need to
generate a phonon dispersion along a new path.</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>TDEP with kaldo will only work for bulk materials (3D) materials</p>
</div>
<section id="input-files-and-formats">
<span id="input-files"></span><h3 id="input-files-and-formats">Input Files and Formats<a class="headerlink" href="#input-files-and-formats" title="Permalink to this heading">¶</a></h3>
<table id="id4">
<caption><span class="caption-text">Input Files</span><a class="headerlink" href="#id4" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Format</p></th>
<th class="head"><p>Config filename</p></th>
<th class="head"><p>ASE format</p></th>
<th class="head"><p>2nd Order FCs</p></th>
<th class="head"><p>3rd Order FCs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>numpy</p></td>
<td><p>replicated_atoms.xyz</p></td>
<td><p>xyz</p></td>
<td><p>second.npy</p></td>
<td><p>third.npz</p></td>
</tr>
<tr class="row-odd"><td><p>eskm</p></td>
<td><p>CONFIG</p></td>
<td><p>dlp4</p></td>
<td><p>Dyn.form</p></td>
<td><p>THIRD</p></td>
</tr>
<tr class="row-even"><td><p>lammps</p></td>
<td><p>replicated_atoms.xyz</p></td>
<td><p>xyz</p></td>
<td><p>Dyn.form</p></td>
<td><p>THIRD</p></td>
</tr>
<tr class="row-odd"><td><p>shengbte</p></td>
<td><p>CONTROL <a class="footnote-reference brackets" href="#f1" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p></td>
<td><p>None <a class="footnote-reference brackets" href="#f2" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a></p></td>
<td><p>FORCE_CONSTANTS_2ND</p></td>
<td><p>FORCE_CONSTANTS_3RD</p></td>
</tr>
<tr class="row-even"><td><p>shengbte-qe</p></td>
<td><p>CONTROL <a class="footnote-reference brackets" href="#f1" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p></td>
<td><p>None</p></td>
<td><p>espresso.ifc2</p></td>
<td><p>FORCE_CONSTANTS_3RD</p></td>
</tr>
<tr class="row-odd"><td><p>hiphive</p></td>
<td><p>atom_prim.xyz + replicated_atoms.xyz</p></td>
<td><p>xyz</p></td>
<td><p>model2.fcs</p></td>
<td><p>model3.fcs</p></td>
</tr>
<tr class="row-even"><td><p>tdep</p></td>
<td><p>POSCAR/UCPOSCAR/SSPOSCAR</p></td>
<td><p>xyz</p></td>
<td><p>second.npy</p></td>
<td><p>third.npz</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes on Formats</p>
<aside class="footnote brackets" id="f1" role="note">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a href="#id1" role="doc-backlink">1</a>,<a href="#id3" role="doc-backlink">2</a>)</span>
<p>The shengbte and shengbte-qe format will look for the “CONTROL” file first, however, if it is not found it will
look for a “POSCAR” file (ASE format “vasp”). If neither are found, it will raise an error.</p>
</aside>
<aside class="footnote brackets" id="f2" role="note">
<span class="label"><span class="fn-bracket">[</span><a href="#id2" role="doc-backlink">2</a><span class="fn-bracket">]</span></span>
<p>The shengbte format does not have a direct equivalent in ASE. You can be create the atoms object manually or
use the import_control_file method.</p>
</aside>
</section>
</section>
<section id="api-reference">
<span id="forceconstants-api"></span><h2 id="api-reference">API Reference<a class="headerlink" href="#api-reference" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="kaldo.forceconstants.ForceConstants">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kaldo.forceconstants.</span></span><span class="sig-name descname"><span class="pre">ForceConstants</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supercell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">third_supercell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'displacement'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/kaldo/forceconstants.html#ForceConstants"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kaldo.forceconstants.ForceConstants" title="Permalink to this definition">¶</a></dt>
<dd><p>A ForceConstants class object is used to create or load the second or third order force constant matrices as well as
store information related to the geometry of the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>Tabulated xyz files</em><em> or </em><em>ASE Atoms object</em>) – The atoms to work on.</p></li>
<li><p><strong>supercell</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>, </em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Size of supercell given by the number of repetitions (l, m, n) of
the small unit cell in each direction.
Default: (1, 1, 1)</p></li>
<li><p><strong>third_supercell</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>, </em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Same as supercell, but for the third order force constant matrix.
If not provided, it’s copied from supercell.
Default: <img alt="self.supercell" class="math" src="../_images/math/11c0006d15164d9da615ed3ccfd97139860f7f16.png"/></p></li>
<li><p><strong>folder</strong> (<em>str</em><em>, </em><em>optional</em>) – Name to be used for the displacement information folder.
Default: ‘displacement’</p></li>
<li><p><strong>distance_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – If the distance between two atoms exceeds threshold, the interatomic
force is ignored.
Default: <img alt="None" class="math" src="../_images/math/66f3449a3b20a6309557813edf86759218d71d30.png"/></p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="kaldo.forceconstants.ForceConstants.n_atoms">
<span class="sig-name descname"><span class="pre">n_atoms</span></span><a class="headerlink" href="#kaldo.forceconstants.ForceConstants.n_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of atoms in the unit cell</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="kaldo.forceconstants.ForceConstants.n_modes">
<span class="sig-name descname"><span class="pre">n_modes</span></span><a class="headerlink" href="#kaldo.forceconstants.ForceConstants.n_modes" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of possible vibrational modes in the system from a lattice dynamics perspective. Equivalent to
3*n_atoms where the factor of 3 comes from the 3 Cartesian directions.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="kaldo.forceconstants.ForceConstants.n_replicas">
<span class="sig-name descname"><span class="pre">n_replicas</span></span><a class="headerlink" href="#kaldo.forceconstants.ForceConstants.n_replicas" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of repeated unit cells represented in the system. Equivalent to np.prod(supercell).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="kaldo.forceconstants.ForceConstants.n_replicated_atoms">
<span class="sig-name descname"><span class="pre">n_replicated_atoms</span></span><a class="headerlink" href="#kaldo.forceconstants.ForceConstants.n_replicated_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of atoms represented in the system. Equivalent to n_atoms * np.prod(supercell)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="kaldo.forceconstants.ForceConstants.cell_inv">
<span class="sig-name descname"><span class="pre">cell_inv</span></span><a class="headerlink" href="#kaldo.forceconstants.ForceConstants.cell_inv" title="Permalink to this definition">¶</a></dt>
<dd><p>A 3x3 matrix which satisfies AB=I where A is the matrix of cell vectors, I is the identity matrix, and B is the
cell_inv matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array(3, 3)</p>
</dd>
</dl>
</dd></dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#kaldo.forceconstants.ForceConstants.elastic_prop" title="kaldo.forceconstants.ForceConstants.elastic_prop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">elastic_prop</span></code></a>()</p></td>
<td><p>Return the stiffness tensor (aka elastic modulus tensor) of the system in GPa.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#kaldo.forceconstants.ForceConstants.from_folder" title="kaldo.forceconstants.ForceConstants.from_folder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_folder</span></code></a>(folder[, supercell, format, ...])</p></td>
<td><p>Create a finite difference object from a folder</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#kaldo.forceconstants.ForceConstants.sigma2_tdep_MD" title="kaldo.forceconstants.ForceConstants.sigma2_tdep_MD"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sigma2_tdep_MD</span></code></a>([fc_file, primitive_file, ...])</p></td>
<td><p>Calculate the sigma2 value using TDEP and MD data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#kaldo.forceconstants.ForceConstants.unfold_third_order" title="kaldo.forceconstants.ForceConstants.unfold_third_order"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unfold_third_order</span></code></a>([reduced_third, ...])</p></td>
<td><p>This method extrapolates a third order force constant matrix from a unit cell into a matrix for a larger supercell.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="kaldo.forceconstants.ForceConstants.from_folder">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_folder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supercell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'numpy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">third_energy_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">third_supercell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_acoustic_sum</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_second</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/kaldo/forceconstants.html#ForceConstants.from_folder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kaldo.forceconstants.ForceConstants.from_folder" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a finite difference object from a folder</p>
<p>The folder should contain the a set of files whose names and contents are dependent on the “format” parameter.
Below is the list required for each format (also found in the api_forceconstants documentation if you prefer
to read it with nicer formatting and explanations).</p>
<p>numpy: replicated_atoms.xyz, second.npy, third.npz
eskm: CONFIG, replicated_atoms.xyz, Dyn.form, THIRD
lammps: replicated_atoms.xyz, Dyn.form, THIRD
shengbte: CONTROL, POSCAR, FORCE_CONSTANTS_2ND/FORCE_CONSTANTS, FORCE_CONSTANTS_3RD
shengbte-qe: CONTROL, POSCAR, espresso.ifc2, FORCE_CONSTANTS_3RD
hiphive: atom_prim.xyz, replicated_atoms.xyz, model2.fcs, model3.fcs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder</strong> (<em>str</em>) – Chosen folder to load in system information.</p></li>
<li><p><strong>supercell</strong> (<em>(</em><em>int</em><em>, </em><em>int</em><em>, </em><em>int</em><em>)</em><em>, </em><em>optional</em>) – Number of unit cells in each cartesian direction replicated to form the input structure.
Default is (1, 1, 1)</p></li>
<li><p><strong>format</strong> (<em>'numpy'</em><em>, </em><em>'eskm'</em><em>, </em><em>'lammps'</em><em>, </em><em>'shengbte'</em><em>, </em><em>'shengbte-qe'</em><em>, </em><em>'hiphive'</em>) – Format of force constant information being loaded into ForceConstants object.
Default is ‘numpy’</p></li>
<li><p><strong>third_energy_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – When importing sparse third order force constant matrices, energies below
the threshold value in magnitude are ignored. Units: eV/Angstrom^3
Default is <img alt="None" class="math" src="../_images/math/66f3449a3b20a6309557813edf86759218d71d30.png"/></p></li>
<li><p><strong>distance_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – When calculating force constants, contributions from atoms further than the
distance threshold will be ignored.</p></li>
<li><p><strong>third_supercell</strong> (<em>(</em><em>int</em><em>, </em><em>int</em><em>, </em><em>int</em><em>)</em><em>, </em><em>optional</em>) – Takes in the unit cell for the third order force constant matrix.
Default is self.supercell</p></li>
<li><p><strong>is_acoustic_sum</strong> (<em>Bool</em><em>, </em><em>optional</em>) – If true, the acoustic sum rule is applied to the dynamical matrix.
Default is False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>forceconstants</strong> – A new instance of the ForceConstants class</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ForceConstants object</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="kaldo.forceconstants.ForceConstants.unfold_third_order">
<span class="sig-name descname"><span class="pre">unfold_third_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reduced_third</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/kaldo/forceconstants.html#ForceConstants.unfold_third_order"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kaldo.forceconstants.ForceConstants.unfold_third_order" title="Permalink to this definition">¶</a></dt>
<dd><p>This method extrapolates a third order force constant matrix from a unit
cell into a matrix for a larger supercell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reduced_third</strong> (<em>array</em><em>, </em><em>optional</em>) – The third order force constant matrix.
Default is <img alt="self.third" class="math" src="../_images/math/15cfbf59c2e9dda1f84c7dff795b1b1d95ca9bc1.png"/></p></li>
<li><p><strong>distance_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – When calculating force constants, contributions from atoms further than
the distance threshold will be ignored.
Default is <img alt="self.distance_threshold" class="math" src="../_images/math/4a3d75911789198a091f9b3cde7f4b1d13300806.png"/></p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="kaldo.forceconstants.ForceConstants.elastic_prop">
<span class="sig-name descname"><span class="pre">elastic_prop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/kaldo/forceconstants.html#ForceConstants.elastic_prop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kaldo.forceconstants.ForceConstants.elastic_prop" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the stiffness tensor (aka elastic modulus tensor) of the system in GPa. This describes the stress-strain
relationship of the material and can sometimes be used as a loose predictor for thermal conductivity. Requires
the dynamical matrix to be loaded or calculated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong> – </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>C_ijkl</strong> – Elasticity tensor in GPa</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array(3, 3, 3, 3)</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="kaldo.forceconstants.ForceConstants.sigma2_tdep_MD">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sigma2_tdep_MD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fc_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'infile.forceconstant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">primitive_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'infile.ucposcar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supercell_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'infile.ssposcar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">md_run</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'dump.xyz'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/kaldo/forceconstants.html#ForceConstants.sigma2_tdep_MD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kaldo.forceconstants.ForceConstants.sigma2_tdep_MD" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the sigma2 value using TDEP and MD data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fc_file</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the force constant file. Default is ‘infile.forceconstant’.</p></li>
<li><p><strong>primitive_file</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the primitive cell file. Default is ‘infile.ucposcar’.</p></li>
<li><p><strong>supercell_file</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the supercell file. Default is ‘infile.ssposcar’.</p></li>
<li><p><strong>md_run</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the MD trajectory file. Default is ‘dump.xyz’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The average sigma2 value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="user_guide.html" title="Interfacing with Other Codes"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Interfacing with Other Codes </span>
              </div>
            </a>
          
          
            <a href="api_phonons.html" title="Phonons"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Phonons </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2020, Giuseppe Barbalinardo, Zekun Chen, Nicholas W. Lundgren, Davide Donadio.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 5.0.1.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>